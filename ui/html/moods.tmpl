<!-- mood/ui/html/moods.tmpl -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{.Title}}</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <!-- Optional Back Arrow -->
        <a href="/" class="back-arrow" aria-label="Back to Home">
            <img src="/static/resources/arrow.png" alt="Back" class="back-arrow-img"> <!-- Adjust path if needed -->
        </a>

        <div class="page-header">{{.HeaderText}}</div> <!-- Display header text -->
        <a href="/mood/new" class="btn add-new-btn">Log New Mood</a> <!-- Button to add new entry -->

        {{if .Moods}} <!-- Check if there are any moods to display -->
        <ul class="mood-list">
        {{range .Moods}} <!-- Loop through each mood entry -->
            {{ $details := GetEmotionDetails .Emotion }} <!-- Get display details for the mood's emotion -->
            <li class="mood-item {{ $details.Color }}"> <!-- List item with emotion-specific color class -->
                <div class="mood-item-content">
                    <div class="mood-title">
                         <span class="mood-emoji">{{ $details.Emoji }}</span> <!-- Display Emoji -->
                         <strong>{{.Title | html}}</strong> <!-- Display Title (escape HTML) -->
                    </div>
                    <p class="mood-text">{{.Content | html}}</p> <!-- Display Content (escape HTML) -->
                    <div class="mood-meta">
                        <time datetime="{{.CreatedAt.Format "2006-01-02T15:04:05Z"}}">
                            Logged: {{ .CreatedAt | HumanDate }} <!-- Use HumanDate helper -->
                        </time>
                        <!-- Only show UpdatedAt if different from CreatedAt (e.g., > 1 minute difference) -->
                        {{ $updatedThreshold := AddMinutes .CreatedAt 1 }}
                        {{if .UpdatedAt.After $updatedThreshold }}
                        <time datetime="{{.UpdatedAt.Format "2006-01-02T15:04:05Z"}}">
                            | Updated: {{ .UpdatedAt | HumanDate }} <!-- Use HumanDate helper -->
                        </time>
                        {{end}}
                    </div>
                </div>
                <div class="edit-delete-buttons">
                    <a href="/mood/edit/{{.ID}}" class="btn edit-btn">Edit</a> <!-- Link to edit form -->
                    <form action="/mood/delete/{{.ID}}" method="POST" style="display: inline;">
                        <!-- Delete button within a form -->
                        <button type="submit" class="btn delete-btn" onclick="return confirm('Are you sure you want to delete this mood entry?');">Delete</button>
                    </form>
                </div>
            </li>
        {{end}} <!-- End of range loop -->
        </ul>
        {{else}}
            <!-- Message shown if no moods exist -->
            <p>No mood entries yet. <a href="/mood/new">Log your first mood!</a></p>
        {{end}} <!-- End of if .Moods -->

    </div>
</body>
</html>